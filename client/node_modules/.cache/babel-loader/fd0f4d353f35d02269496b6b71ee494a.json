{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\src\\\\components\\\\Messaging.js\";\nimport React, { Component } from 'react';\nimport { send, getUserName } from '../HelperFunctions';\nimport ContactList from './ContactList';\nimport Conversation from './Conversation';\nimport '../style/messaging.css';\nimport '../style/index.css';\n\nvar io = require('socket.io-client');\n\nvar Messaging =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Messaging, _Component);\n\n  function Messaging() {\n    var _this;\n\n    _classCallCheck(this, Messaging);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Messaging).call(this));\n\n    _this.updateContactId = function (newContactId) {\n      _this.setState({\n        contact_id: newContactId\n      });\n\n      send(\"GET\", \"/api/messages/?recipient=\" + newContactId, {}, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            messages: res\n          });\n        }\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.updateMessagesList = function (newMessage) {\n      if (newMessage.sender === _this.state.contact_id && newMessage.recipient === getUserName() || newMessage.sender === getUserName() && newMessage.recipient === _this.state.contact_id) {\n        _this.state.messages.push(newMessage);\n\n        _this.setState({\n          messages: _this.state.messages\n        });\n      }\n    };\n\n    _this.state = {\n      contact_id: \"\",\n      contacts: [],\n      messages: []\n    };\n    _this.socket = io();\n    return _this;\n  }\n\n  _createClass(Messaging, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      send(\"GET\", \"/api/users/\", {}, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            contacts: res\n          });\n        }\n      }.bind(this));\n      this.socket.on(\"messagesUpdate\", this.updateMessagesList);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.socket.close();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"messagingContainer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, React.createElement(ContactList, {\n        contacts: this.state.contacts,\n        updateContactId: this.updateContactId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }), React.createElement(Conversation, {\n        socket: this.socket,\n        key: this.state.contact_id,\n        userId: this.state.contact_id,\n        messages: this.state.messages,\n        updateMessages: this.updateMessagesList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Messaging;\n}(Component);\n\nexport default Messaging;","map":{"version":3,"sources":["C:\\Users\\Jun\\Documents\\UTSC\\C09\\project-flex\\client\\src\\components\\Messaging.js"],"names":["React","Component","send","getUserName","ContactList","Conversation","io","require","Messaging","updateContactId","newContactId","setState","contact_id","err","res","console","log","messages","bind","updateMessagesList","newMessage","sender","state","recipient","push","contacts","socket","on","close"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {send, getUserName} from '../HelperFunctions';\nimport ContactList from './ContactList';\nimport Conversation from './Conversation';\nimport '../style/messaging.css';\nimport '../style/index.css';\nconst io = require('socket.io-client');\n\nclass Messaging extends Component {\n\tconstructor(){\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tcontact_id : \"\",\n\t\t\tcontacts: [],\n\t\t\tmessages: []\n\t\t};\n\t\tthis.socket = io();\n\t}\n\n\tcomponentDidMount() {\n\t\tsend(\"GET\", \"/api/users/\", {}, function(err, res) {\n\t\t\tif(err) console.log(err);\n\t\t\telse{\n\t\t\t\tthis.setState({\n\t\t\t\t\tcontacts: res\n\t\t\t\t});\n\t\t\t}\n\t\t}.bind(this));\n\t\tthis.socket.on(\"messagesUpdate\", this.updateMessagesList);\n\t}\n\n\tcomponentWillUnmount(){\n\t\tthis.socket.close();\n\t}\n\n\tupdateContactId = (newContactId) => {\n\t\tthis.setState({contact_id: newContactId})\n\t\tsend(\"GET\", \"/api/messages/?recipient=\" + newContactId, {}, function(err, res) {\n\t\t\tif(err) console.log(err);\n\t\t\telse{\n\t\t\t\tthis.setState({\n\t\t\t\t\tmessages: res\n\t\t\t\t});\n\t\t\t}\n\t\t}.bind(this));\n\t};\n\n\tupdateMessagesList = (newMessage) => {\n\t\tif((newMessage.sender === this.state.contact_id && newMessage.recipient === getUserName()) ||\n\t\t\t(newMessage.sender === getUserName() && newMessage.recipient === this.state.contact_id)){\n\t\t\tthis.state.messages.push(newMessage);\n\t\t\tthis.setState({messages: this.state.messages});\n\t\t}\n\t};\n\n\trender(){\n\t\treturn (\n\t\t\t\t<div className=\"messagingContainer\">\n\t\t\t\t\t<ContactList contacts={this.state.contacts} updateContactId={this.updateContactId} />\n\t\t\t\t\t<Conversation socket={this.socket} key={this.state.contact_id} userId={this.state.contact_id} messages={this.state.messages} updateMessages={this.updateMessagesList} />\n\t\t\t\t</div>\n\t\t\t);\n\t}\n}\n\nexport default Messaging;"]},"metadata":{},"sourceType":"module"}