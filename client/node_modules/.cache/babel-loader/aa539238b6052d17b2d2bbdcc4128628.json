{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\src\\\\components\\\\Messaging.js\";\nimport React, { Component } from 'react';\nimport { send, getUserName } from '../HelperFunctions';\nimport ContactList from './ContactList';\nimport Conversation from './Conversation';\nimport '../style/messaging.css';\nimport '../style/index.css';\n\nvar io = require('socket.io-client');\n\nvar Messaging =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Messaging, _Component);\n\n  function Messaging() {\n    var _this;\n\n    _classCallCheck(this, Messaging);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Messaging).call(this));\n\n    _this.updateContactId = function (newContactId) {\n      send(\"GET\", \"/api/messages/?recipient=\" + newContactId, {}, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            messages: res,\n            contact_id: newContactId\n          });\n        }\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.updateMessagesList = function (newMessage) {\n      if (newMessage.sender === _this.state.contact_id && newMessage.recipient === getUserName() || newMessage.sender === getUserName() && newMessage.recipient === _this.state.contact_id) {\n        _this.setState({\n          messages: [].concat(_toConsumableArray(_this.state.messages), [newMessage])\n        });\n      }\n    };\n\n    _this.state = {\n      contact_id: \"\",\n      contacts: [],\n      messages: []\n    };\n    _this.socket = io();\n    return _this;\n  }\n\n  _createClass(Messaging, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      send(\"GET\", \"/api/users/\", {}, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            contacts: res\n          });\n        }\n      }.bind(this));\n      this.socket.on(\"messagesUpdate\", this.updateMessagesList);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.socket.close();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"messagingContainer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }, React.createElement(ContactList, {\n        contacts: this.state.contacts,\n        updateContactId: this.updateContactId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }), React.createElement(Conversation, {\n        socket: this.socket,\n        userId: this.state.contact_id,\n        messages: this.state.messages,\n        updateMessages: this.updateMessagesList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Messaging;\n}(Component);\n\nexport default Messaging;","map":{"version":3,"sources":["C:\\Users\\Jun\\Documents\\UTSC\\C09\\project-flex\\client\\src\\components\\Messaging.js"],"names":["React","Component","send","getUserName","ContactList","Conversation","io","require","Messaging","updateContactId","newContactId","err","res","console","log","setState","messages","contact_id","bind","updateMessagesList","newMessage","sender","state","recipient","contacts","socket","on","close"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,IAAR,EAAcC,WAAd,QAAgC,oBAAhC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAO,wBAAP;AACA,OAAO,oBAAP;;AACA,IAAMC,EAAE,GAAGC,OAAO,CAAC,kBAAD,CAAlB;;IAEMC,S;;;;;AACL,uBAAa;AAAA;;AAAA;;AACZ;;AADY,UA0BbC,eA1Ba,GA0BK,UAACC,YAAD,EAAkB;AACnCR,MAAAA,IAAI,CAAC,KAAD,EAAQ,8BAA8BQ,YAAtC,EAAoD,EAApD,EAAwD,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC9E,YAAGD,GAAH,EAAQE,OAAO,CAACC,GAAR,CAAYH,GAAZ,EAAR,KACI;AACH,eAAKI,QAAL,CAAc;AACbC,YAAAA,QAAQ,EAAEJ,GADG;AAEbK,YAAAA,UAAU,EAAEP;AAFC,WAAd;AAIA;AACD,OAR2D,CAQ1DQ,IAR0D,uDAAxD,CAAJ;AASA,KApCY;;AAAA,UAsCbC,kBAtCa,GAsCQ,UAACC,UAAD,EAAgB;AACpC,UAAIA,UAAU,CAACC,MAAX,KAAsB,MAAKC,KAAL,CAAWL,UAAjC,IAA+CG,UAAU,CAACG,SAAX,KAAyBpB,WAAW,EAApF,IACDiB,UAAU,CAACC,MAAX,KAAsBlB,WAAW,EAAjC,IAAuCiB,UAAU,CAACG,SAAX,KAAyB,MAAKD,KAAL,CAAWL,UAD7E,EACyF;AACxF,cAAKF,QAAL,CAAc;AAACC,UAAAA,QAAQ,+BAAM,MAAKM,KAAL,CAAWN,QAAjB,IAA2BI,UAA3B;AAAT,SAAd;AACA;AACD,KA3CY;;AAEZ,UAAKE,KAAL,GAAa;AACZL,MAAAA,UAAU,EAAG,EADD;AAEZO,MAAAA,QAAQ,EAAE,EAFE;AAGZR,MAAAA,QAAQ,EAAE;AAHE,KAAb;AAKA,UAAKS,MAAL,GAAcnB,EAAE,EAAhB;AAPY;AAQZ;;;;wCAEmB;AACnBJ,MAAAA,IAAI,CAAC,KAAD,EAAQ,aAAR,EAAuB,EAAvB,EAA2B,UAASS,GAAT,EAAcC,GAAd,EAAmB;AACjD,YAAGD,GAAH,EAAQE,OAAO,CAACC,GAAR,CAAYH,GAAZ,EAAR,KACI;AACH,eAAKI,QAAL,CAAc;AACbS,YAAAA,QAAQ,EAAEZ;AADG,WAAd;AAGA;AACD,OAP8B,CAO7BM,IAP6B,CAOxB,IAPwB,CAA3B,CAAJ;AAQA,WAAKO,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,KAAKP,kBAAtC;AACA;;;2CAEqB;AACrB,WAAKM,MAAL,CAAYE,KAAZ;AACA;;;6BAqBO;AACP,aACE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC,oBAAC,WAAD;AAAa,QAAA,QAAQ,EAAE,KAAKL,KAAL,CAAWE,QAAlC;AAA4C,QAAA,eAAe,EAAE,KAAKf,eAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,EAEC,oBAAC,YAAD;AAAc,QAAA,MAAM,EAAE,KAAKgB,MAA3B;AAAmC,QAAA,MAAM,EAAE,KAAKH,KAAL,CAAWL,UAAtD;AAAkE,QAAA,QAAQ,EAAE,KAAKK,KAAL,CAAWN,QAAvF;AAAiG,QAAA,cAAc,EAAE,KAAKG,kBAAtH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFD,CADF;AAMA;;;;EArDsBlB,S;;AAwDxB,eAAeO,SAAf","sourcesContent":["import React, {Component} from 'react';\nimport {send, getUserName} from '../HelperFunctions';\nimport ContactList from './ContactList';\nimport Conversation from './Conversation';\nimport '../style/messaging.css';\nimport '../style/index.css';\nconst io = require('socket.io-client');\n\nclass Messaging extends Component {\n\tconstructor(){\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tcontact_id : \"\",\n\t\t\tcontacts: [],\n\t\t\tmessages: []\n\t\t};\n\t\tthis.socket = io();\n\t}\n\n\tcomponentDidMount() {\n\t\tsend(\"GET\", \"/api/users/\", {}, function(err, res) {\n\t\t\tif(err) console.log(err);\n\t\t\telse{\n\t\t\t\tthis.setState({\n\t\t\t\t\tcontacts: res\n\t\t\t\t});\n\t\t\t}\n\t\t}.bind(this));\n\t\tthis.socket.on(\"messagesUpdate\", this.updateMessagesList);\n\t}\n\n\tcomponentWillUnmount(){\n\t\tthis.socket.close();\n\t}\n\n\tupdateContactId = (newContactId) => {\n\t\tsend(\"GET\", \"/api/messages/?recipient=\" + newContactId, {}, function(err, res) {\n\t\t\tif(err) console.log(err);\n\t\t\telse{\n\t\t\t\tthis.setState({\n\t\t\t\t\tmessages: res,\n\t\t\t\t\tcontact_id: newContactId\n\t\t\t\t});\n\t\t\t}\n\t\t}.bind(this));\n\t};\n\n\tupdateMessagesList = (newMessage) => {\n\t\tif((newMessage.sender === this.state.contact_id && newMessage.recipient === getUserName()) ||\n\t\t\t(newMessage.sender === getUserName() && newMessage.recipient === this.state.contact_id)){\n\t\t\tthis.setState({messages: [...this.state.messages, newMessage]});\n\t\t}\n\t};\n\n\trender(){\n\t\treturn (\n\t\t\t\t<div className=\"messagingContainer\">\n\t\t\t\t\t<ContactList contacts={this.state.contacts} updateContactId={this.updateContactId} />\n\t\t\t\t\t<Conversation socket={this.socket} userId={this.state.contact_id} messages={this.state.messages} updateMessages={this.updateMessagesList} />\n\t\t\t\t</div>\n\t\t\t);\n\t}\n}\n\nexport default Messaging;"]},"metadata":{},"sourceType":"module"}