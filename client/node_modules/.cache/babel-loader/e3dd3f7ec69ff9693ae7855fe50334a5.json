{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Jun\\\\Documents\\\\UTSC\\\\C09\\\\project-flex\\\\client\\\\src\\\\components\\\\takeOrder.js\";\nimport React, { Component } from 'react';\nimport CategoryItem from './category';\nimport OrderListItem from './orderListItem';\nimport OrderTotal from './orderTotal';\nimport { send } from '../HelperFunctions';\nimport Payment from './paymentPage';\n\nvar OrderListMenu =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(OrderListMenu, _Component);\n\n  function OrderListMenu(props) {\n    var _this;\n\n    _classCallCheck(this, OrderListMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderListMenu).call(this, props));\n\n    _this.getOrderList = function (orderNumber) {\n      send(\"GET\", \"/api/orderItems/\" + orderNumber + \"/\", null, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            orderList: res\n          });\n        }\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.getCategoryItems = function (category) {\n      send(\"GET\", \"/api/menuItems/\", null, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            menuItems: res,\n            categoryItems: res.filter(function (item) {\n              return item.category === category.category_name;\n            })\n          });\n        }\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.getCategories = function () {\n      send(\"GET\", \"/api/categories/\", null, function (err, res) {\n        if (err) console.log(err);else {\n          this.setState({\n            categories: res,\n            selectedCategory: res[0]\n          });\n          this.getCategoryItems(res[0]);\n        }\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.placeOrder = function () {\n      if (_this.state.orderList.length !== 0) {\n        var orderNumber = _this.state.orderNumber;\n        var total = (_this.calculateSubTotal() * 1.13).toFixed(2);\n        var orderData = {\n          order_number: orderNumber,\n          number_of_items: _this.state.orderList.length,\n          total: total,\n          completed: false,\n          payed: false\n        };\n\n        if (_this.props.onEdit) {\n          send(\"DELETE\", \"/api/order/items/\", {\n            orderNumber: orderNumber\n          }, function (err, res) {\n            if (err) console.log(err);else {\n              send(\"PATCH\", \"/api/order/total/\", {\n                total: total,\n                orderNumber: orderNumber\n              }, function (err, res) {\n                if (err) console.log(err);\n              });\n              this.sendOrderItems();\n              this.setState({\n                orderList: []\n              });\n            }\n          }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n        } else {\n          // for each item in itemList, store in database with the current order number\n          // stored in state of App.js\n          send(\"POST\", \"/api/orders/\", orderData, function (err, res) {\n            if (err) console.log(err);else {\n              this.sendOrderItems(); // increment order number in App.js state\n\n              this.props.incrementOrderNum();\n              this.setState({\n                orderList: [],\n                orderNumber: this.state.orderNumber + 1\n              });\n            }\n          }.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n        }\n      }\n    };\n\n    _this.sendOrderItems = function () {\n      // for each item in itemList, store in database with the current order number\n      _this.state.orderList.map(function (item) {\n        return send(\"POST\", \"/api/orderItems/\", {\n          id: item.id,\n          order_number: _this.state.orderNumber,\n          name: item.name,\n          crossed: item.crossed,\n          price: item.price,\n          quantity: item.quantity\n        }, function (err, res) {\n          if (err) console.log(err);\n        });\n      });\n    };\n\n    _this.categoryOnClick = function (C) {\n      var items = _this.state.menuItems.filter(function (item) {\n        return item.category === C.category_name;\n      });\n\n      _this.setState({\n        selectedCategory: C,\n        categoryItems: items\n      });\n    };\n\n    _this.addItem = function (item) {\n      var temp = [].concat(_toConsumableArray(_this.state.orderList), [item]);\n\n      _this.setState({\n        orderList: temp\n      });\n    };\n\n    _this.toggleCrossOut = function (id) {\n      _this.setState({\n        orderList: _this.state.orderList.map(function (item) {\n          if (item.id === id) {\n            return _objectSpread({}, item, {\n              crossed: !item.crossed\n            });\n          } else {\n            return item;\n          }\n        })\n      });\n    };\n\n    _this.handleDelete = function (id) {\n      _this.setState({\n        orderList: _this.state.orderList.filter(function (item) {\n          return item.id !== id;\n        })\n      });\n    };\n\n    _this.decrementQty = function (id) {\n      _this.setState({\n        orderList: _this.state.orderList.map(function (item) {\n          if (item.id === id && item.quantity !== 1) {\n            return _objectSpread({}, item, {\n              quantity: item.quantity - 1\n            });\n          } else {\n            return item;\n          }\n        })\n      });\n    };\n\n    _this.incrementQty = function (id) {\n      _this.setState({\n        orderList: _this.state.orderList.map(function (item) {\n          if (item.id === id) {\n            return _objectSpread({}, item, {\n              quantity: item.quantity + 1\n            });\n          } else {\n            return item;\n          }\n        })\n      });\n    };\n\n    _this.changeQty = function (event, id) {\n      _this.setState({\n        orderList: _this.state.orderList.map(function (item) {\n          if (item.id === id) {\n            return _objectSpread({}, item, {\n              quantity: event.target.value ? parseInt(event.target.value, 10) : \"\"\n            });\n          } else {\n            return item;\n          }\n        })\n      });\n    };\n\n    _this.calculateSubTotal = function () {\n      var itemsList = _this.state.orderList;\n      var subTotal = 0;\n      var items = itemsList.filter(function (item) {\n        return !item.crossed;\n      });\n      items.map(function (item) {\n        return subTotal += parseFloat(item.price) * item.quantity;\n      });\n      return subTotal;\n    };\n\n    _this.displayPayment = function () {\n      _this.setState({\n        display: \"pay\"\n      });\n    };\n\n    _this.displayTakeOrder = function () {\n      _this.setState({\n        display: \"takeOrder\"\n      });\n    };\n\n    _this.state = {\n      categories: [],\n      selectedCategory: null,\n      menuItems: [],\n      categoryItems: [],\n      orderList: [],\n      display: \"takeOrder\",\n      orderNumber: _this.props.orderNumber,\n      paymentAmount: 0.00\n    };\n\n    if (_this.props.onEdit) {\n      _this.getOrderList(_this.props.orderNumber);\n    }\n\n    ;\n\n    _this.getCategories();\n\n    return _this;\n  } // get order list with given ordernumber\n\n\n  _createClass(OrderListMenu, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.display === \"takeOrder\") {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"orderMenuTitles\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          id: \"order_list_title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, \" Order #\", this.state.orderNumber, \" \"), React.createElement(\"h1\", {\n          id: \"menu_title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }, \" Menu \")), React.createElement(\"div\", {\n          className: \"orderListMenu\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"orderList\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, this.state.orderList.map(function (item) {\n          return React.createElement(OrderListItem, {\n            key: item.id,\n            item: item,\n            toggleCrossOut: function toggleCrossOut() {\n              return _this2.toggleCrossOut(item.id);\n            },\n            handleDelete: function handleDelete() {\n              return _this2.handleDelete(item.id);\n            },\n            decrementQty: function decrementQty() {\n              return _this2.decrementQty(item.id);\n            },\n            incrementQty: function incrementQty() {\n              return _this2.incrementQty(item.id);\n            },\n            changeQty: function changeQty(event) {\n              return _this2.changeQty(event, item.id);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 227\n            },\n            __self: this\n          });\n        })), React.createElement(\"div\", {\n          className: \"menu\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"categories\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 238\n          },\n          __self: this\n        }, this.state.categories.map(function (category, index) {\n          return React.createElement(\"button\", {\n            type: \"button\",\n            className: \"category\",\n            key: category.category_name,\n            style: _this2.state.selectedCategory.category_name === category.category_name ? {\n              \"backgroundColor\": category.color\n            } : null,\n            onClick: _this2.categoryOnClick.bind(_this2, category),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 240\n            },\n            __self: this\n          }, category.category_name);\n        }), React.createElement(\"div\", {\n          className: \"animation start-home\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"items\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248\n          },\n          __self: this\n        }, this.state.categoryItems.map(function (item, index) {\n          return React.createElement(CategoryItem, {\n            addItem: _this2.addItem,\n            key: index,\n            itemName: item.name,\n            price: item.price,\n            color: _this2.state.selectedCategory.color,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 249\n            },\n            __self: this\n          });\n        })), React.createElement(OrderTotal, {\n          calculateSubTotal: this.calculateSubTotal,\n          placeOrder: this.placeOrder,\n          displayPayment: this.displayPayment,\n          onEdit: this.props.onEdit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 256\n          },\n          __self: this\n        }))));\n      } else if (this.state.display === \"pay\") {\n        return React.createElement(Payment, {\n          orderNumber: this.state.orderNumber,\n          items: this.state.orderList,\n          total: this.calculateSubTotal() * 1.13,\n          displayTakeOrder: this.displayTakeOrder,\n          viewOrders: this.props.viewOrders,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        });\n      }\n    }\n  }]);\n\n  return OrderListMenu;\n}(Component);\n\nexport { OrderListMenu as default };","map":{"version":3,"sources":["C:\\Users\\Jun\\Documents\\UTSC\\C09\\project-flex\\client\\src\\components\\takeOrder.js"],"names":["React","Component","CategoryItem","OrderListItem","OrderTotal","send","Payment","OrderListMenu","props","getOrderList","orderNumber","err","res","console","log","setState","orderList","bind","getCategoryItems","category","menuItems","categoryItems","filter","item","category_name","getCategories","categories","selectedCategory","placeOrder","state","length","total","calculateSubTotal","toFixed","orderData","order_number","number_of_items","completed","payed","onEdit","sendOrderItems","incrementOrderNum","map","id","name","crossed","price","quantity","categoryOnClick","C","items","addItem","temp","toggleCrossOut","handleDelete","decrementQty","incrementQty","changeQty","event","target","value","parseInt","itemsList","subTotal","parseFloat","displayPayment","display","displayTakeOrder","paymentAmount","index","color","viewOrders"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport CategoryItem from './category';\nimport OrderListItem from './orderListItem';\nimport OrderTotal from './orderTotal';\nimport {send} from '../HelperFunctions';\nimport Payment from './paymentPage';\n\nexport default class OrderListMenu extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      categories: [],\n      selectedCategory: null,\n      menuItems: [],\n      categoryItems:[],\n      orderList: [],\n      display: \"takeOrder\",\n      orderNumber: this.props.orderNumber,\n      paymentAmount: 0.00\n    };\n    \n    if(this.props.onEdit) {this.getOrderList(this.props.orderNumber)};\n\n    this.getCategories();\n  }\n\n  // get order list with given ordernumber\n  getOrderList = (orderNumber) => {\n    send(\"GET\", \"/api/orderItems/\" + orderNumber + \"/\", null, function(err, res) {\n      if(err) console.log(err);\n      else{\n        this.setState({\n          orderList: res\n        });\n      }\n    }.bind(this));   \n  }\n\n  // fetch category items from database and initialize states\n  getCategoryItems = (category) => {\n    send(\"GET\", \"/api/menuItems/\", null, function(err, res) {\n      if(err) console.log(err);\n      else{\n        this.setState({\n          menuItems: res,\n          categoryItems: res.filter(item => item.category === category.category_name)\n        });\n      }\n    }.bind(this));\n  }\n\n  // fetch categories and items from database and initialize this.state\n  getCategories = () => {\n\t\tsend(\"GET\", \"/api/categories/\", null, function(err, res) {\n      if(err) console.log(err);\n      else{\n        this.setState({\n          categories: res,\n          selectedCategory: res[0]\n        });\n        this.getCategoryItems(res[0]);\n      }\n    }.bind(this));\n  }\n\n  placeOrder = () => {\n    if(this.state.orderList.length !== 0) {\n      let orderNumber = this.state.orderNumber;\n      let total = (this.calculateSubTotal() * 1.13).toFixed(2);\n      let orderData = {order_number: orderNumber, \n        number_of_items: this.state.orderList.length,\n        total: total,\n        completed: false,\n        payed:false};\n      if (this.props.onEdit) {\n        send(\"DELETE\", \"/api/order/items/\", {orderNumber: orderNumber}, function(err, res) {\n          if(err) console.log(err);\n          else{\n              send(\"PATCH\", \"/api/order/total/\", {total: total, orderNumber: orderNumber}, function(err, res){\n                if(err) console.log(err);\n              });\n              this.sendOrderItems();\n              this.setState({orderList: []});\n          }\n        }.bind(this));\n      } else {\n        // for each item in itemList, store in database with the current order number\n        // stored in state of App.js\n        send(\"POST\", \"/api/orders/\", orderData, function(err, res) {\n          if(err) console.log(err);\n          else{\n            this.sendOrderItems();\n            // increment order number in App.js state\n            this.props.incrementOrderNum();\n            this.setState({orderList: [], orderNumber: this.state.orderNumber + 1});\n          }\n        }.bind(this));\n      }\n    }\n  }\n\n  sendOrderItems = () => {\n      // for each item in itemList, store in database with the current order number\n      this.state.orderList.map(item => send(\"POST\", \"/api/orderItems/\", {\n        id: item.id,\n        order_number: this.state.orderNumber,\n        name: item.name,\n        crossed: item.crossed,\n        price: item.price,\n        quantity: item.quantity\n      }, function(err, res) {if(err) console.log(err);}));\n  }\n\n  categoryOnClick = (C) => {\n    let items = this.state.menuItems.filter(item => item.category === C.category_name)\n    this.setState({\n      selectedCategory: C,\n      categoryItems: items\n    });\n  }\n\n  addItem = (item) => {\n    const temp = [...this.state.orderList, item];\n    this.setState({\n      orderList: temp\n    });\n  }\n\n  toggleCrossOut = (id) => {\n    this.setState({\n      orderList: this.state.orderList.map(item => {\n        if (item.id === id) {\n          return {\n            ...item, \n            crossed: !item.crossed\n          };\n        } else {\n          return item;\n        }\n      })\n    });\n  };\n\n  handleDelete = (id) => {\n    this.setState({\n      orderList: this.state.orderList.filter(item => item.id !== id)\n    })\n  };\n\n  decrementQty = (id) => {\n    this.setState({\n      orderList: this.state.orderList.map(item => {\n        if (item.id === id && item.quantity !== 1) {\n          return {\n            ...item, \n            quantity: item.quantity - 1\n          };\n        } else {\n          return item;\n        }\n      })\n    });  \n  }\n\n  incrementQty = (id) => {\n    this.setState({\n      orderList: this.state.orderList.map(item => {\n        if (item.id === id) {\n          return {\n            ...item, \n            quantity: item.quantity + 1\n          };\n        } else {\n          return item;\n        }\n      })\n    });  \n  }\n\n  changeQty = (event, id) => {\n    this.setState({\n      orderList: this.state.orderList.map(item => {\n        if (item.id === id) {\n          return {\n            ...item, \n            quantity: event.target.value ? parseInt(event.target.value, 10) : \"\"\n          };\n        } else {\n          return item;\n        }\n      })\n    }); \n  }\n\n  calculateSubTotal = () => {\n    let itemsList = this.state.orderList;\n    let subTotal = 0;\n    let items = itemsList.filter(item => !item.crossed);\n    items.map(item => subTotal += (parseFloat(item.price)) * item.quantity);\n    return subTotal\n  };\n\n  displayPayment = () => {\n    this.setState({\n      display: \"pay\"\n    });\n  }\n\n  displayTakeOrder = () => {\n    this.setState({\n      display: \"takeOrder\"\n    });\n  }\n\n  render() {\n    if (this.state.display === \"takeOrder\") {\n      return (\n        <div>\n          <div className=\"orderMenuTitles\">\n            <h1 id=\"order_list_title\"> Order #{this.state.orderNumber} </h1>\n            <h1 id=\"menu_title\"> Menu </h1>\n          </div>\n          <div className=\"orderListMenu\">\n            <div className=\"orderList\">\n              {this.state.orderList.map((item) => \n                <OrderListItem \n                  key={item.id}\n                  item={item}\n                  toggleCrossOut={() => this.toggleCrossOut(item.id)}\n                  handleDelete={() =>  this.handleDelete(item.id)}\n                  decrementQty={() => this.decrementQty(item.id)}\n                  incrementQty={() => this.incrementQty(item.id)}\n                  changeQty={(event) => this.changeQty(event, item.id)}\n                />)}\n            </div>\n            <div className=\"menu\">\n              <div className=\"categories\">\n                {this.state.categories.map((category, index) => \n                  <button type=\"button\" className=\"category\" key={category.category_name}\n                    style={this.state.selectedCategory.category_name === category.category_name ? \n                      {\"backgroundColor\": category.color} : null}\n                    onClick={this.categoryOnClick.bind(this, category)}>\n                    {category.category_name}\n                  </button>)}\n                <div className=\"animation start-home\"></div>\n              </div>\n              <div className=\"items\">\n                {this.state.categoryItems.map((item, index) => <CategoryItem \n                  addItem={this.addItem}\n                  key={index}\n                  itemName={item.name}\n                  price={item.price}\n                  color={this.state.selectedCategory.color}/>)}\n              </div>\n              <OrderTotal calculateSubTotal={this.calculateSubTotal} \n                placeOrder={this.placeOrder} \n                displayPayment={this.displayPayment}\n                onEdit={this.props.onEdit}/>\n            </div>\n          </div>\n        </div>\n      );      \n    }\n    else if(this.state.display === \"pay\") {\n      return(\n        <Payment \n          orderNumber={this.state.orderNumber}\n          items={this.state.orderList}\n          total={this.calculateSubTotal()*1.13}\n          displayTakeOrder={this.displayTakeOrder}\n          viewOrders={this.props.viewOrders}/>\n      )\n    }\n  }\n}"]},"metadata":{},"sourceType":"module"}